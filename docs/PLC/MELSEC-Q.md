# PLC基礎與進階應用全攻略：原理、指令、應用範例與圖像化流程解析

## 前言

這次我徹底整理了PLC（可程式邏輯控制器）從基礎到進階的核心知識，依據你給的筆記，讓所有內容都有畫面感。無論是硬體結構、接線細節、邏輯指令還是實務應用流程，我都用盡可能「具像化」的敘述方式重新詮釋，確保你能像心裡描圖一樣理解自動化工控的每個步驟！

## 一、PLC硬體架構&接線圖像化

### 1\.1 輸入/輸出模組與COM點（公共端）觀念

• **輸入（Xn）/輸出（Yn）點**：想像每個輸入/輸出是插在控制器上的插槽，把現場感測器或執行器的訊號導進去。

• **COM點**：像所有設備共用的一條回流管道，是訊號流動回家的路；沒有這一筆回家，電路就不成迴路。

語言圖像 — 接線整體流程：

這就像水流必須繞個圈回來，漏掉任何一段都會變成死水或訊號失聯。

### 1\.2 觸點(常開/常閉)圖像

• **a接點（常開）**：沒按像一扇關著的門，一按就打開。

• **b接點（常閉）**：沒按門是開著的，一按下去反而闔上。

在程式中像組積木，可以隨意堆疊成複雜邏輯網路。

## 二、PLC梯形圖程式邏輯

### 2\.1 觸點與線圈—運作視覺化

• 觸點可重複用，想像一個條件（例如按鈕X0），能同時開啟多組不同的流程大門。

• 線圈就像控制開關，只能有唯一一個最終決定者（避免重複賦值）。

### 2\.2 維持與瞬間狀態—SET/RST/ONESHOT

• **SET**：像用釘書機把開關釘「開」住。

• **RST**：把釘釘子拔掉，回到「關」的狀態。

• **ONESHOT（LDP/LDF）**：按鈕像是照相機快門，只在快門瞬間「咔嚓」響一下。

例如：

• LDP(X0)：X0剛從沒按變有按的一瞬間，信號送出一次

• LDF(X0)：X0剛從有按變沒按的瞬間，信號出現一次

### 2\.3 單汽缸流程文字圖像化

這像打地鼠：你拍下按鈕→地鼠（汽缸）冒頭→眼見到位訊號（感測器）→「歸位」準備下次出現。

### 雙線圈衝突範例（文字圖像）

如同一根拉繩同時被兩人拉扯，結果未必一致，最後一個發令者說了算，需靠分割子程序來化解。

## 三、進階結構—子程序與指標

### 3\.1 主/子程序分流

• 像在大型工廠每個工作區各自有「專屬流程」

• 指標（P1、P2…）像指路牌，明確標註要去哪一區呼叫動作

• 每個子程序只管一種任務，避免工作人員（線圈）同時接到相反命令

### 3\.2 子程序調用—語言圖像

## 四、數值與字串運算/比較

### 4\.1 基本數值操作圖像

• **整數加減/乘除**：像在帳本上即時記錄流水帳，例如MOV是把一筆數字「搬到」新頁。

• **字串操作**：如同剪貼板搬動名字、序號（$MOV）。

### 4\.2 數值/字串判斷語言化流程

販賣機例：

防止重複出貨可加反向條件，如LDI（條件為假時有動作），像裝個「只一次」的保險閘。

## 五、內部元件與記憶保存

• **輔助繼電器**像隱身在系統內部的隱形手（SM400等），只在特定控制場景下亮相

• **鎖存/非鎖存繼電器**：

• 鎖存（O）：斷電能記住過去狀態

• 非鎖存（X）：一斷電，一切歸零

• **警報繼電器**：當特殊事件來臨時，像警示燈突然閃爍；LEDR指令能把警報歸零

• **B鏈結繼電器**：負責不同區域或機台間的訊號串接

## 六、計時/記數/順序控制語言化

### 6\.1 定時器應用

• 低速定時器=普通計時碼表，高速定時器=高精度運動手錶

• 累計型：像儲蓄罐，不管多少次，只要加滿就觸發

• 斷電延遲：想像賓館房間，退房後燈還亮一會兒

### 6\.2 計數器

• 三菱C指令，就像數數機，ONESHOT讓每個物件只有一次機會記數，下降沿訊號超精準

• 可自動或條件回零，彈性設置

### 6\.3 順序控制語言圖像

像桌遊闖關，走到終點可跳過剩餘流程，全部完成後自動回原點等待下一回合。

## 七、I/O模組、CCLINK與現場連線過程

• **CCLINK模組**：像高速公路換乘站，設備與PLC間串成菊花鏈，每一節都要設定自己的位置站（編號）、流量（波特率）

語言化設備串連圖：

每台設備有專屬「門牌號碼」，系統才知道要把指令送去哪家。

## 八、元件選擇與Tips

• **繼電器輸出**：像手動開關，電流大但速度慢

• **晶體管輸出**：電子觸控，響應迅速但負載小

• **共陽/共陰**（源型/漏型）：快速分辨接線哪頭「回地」、哪邊接電源

• **進位制與記憶體**：

• 1字節=8位，2字節=1字(WORD)

• 空間編碼就像城市地址，每一區都有自己的容量/門牌

## 九、系統項目設計完整流程語言圖

1\. 工序分析（像寫劇本，每個角色動作都規劃好）

2\. IO點分配 & 機型選擇（分好每個設備用哪個插孔）

3\. 畫電路圖（設計城市地圖）

4\. 實體接線 & 安裝（建設城市道路，東西都要對應到位）

5\. 硬體設備與PLC連結（檢查所有交通網路是否暢通）

6\. 寫程式 & 加註解（說明書也不能忘）

7\. 調試/優化（路測、查Bug）

8\. 提交驗收 & 撰寫操作說明（教用戶怎麼玩這座城）

## 結語

PLC設計與應用就是不斷把抽象自動化需求，化為看得見、想得到、做得出的邏輯地圖。每個步驟、每個流程圖 - 無論用文字還是圖像—都讓現場轉得更順、腦中思路更清。建議多練習流程語言化，日後不只是設計PLC，就是解構任何複雜系統也會游刃有餘！

\----------------------------------------------------------------------------------

## 基礎架構與電氣原理 🧩

### 1\.1 PLC 輸入/輸出與接線規則

PLC 輸入端根據現場開關分類為：

• **常開（a點）**：按下或導通時才形成電路

• **常閉（b點）**：未操作時導通，操作時開路

所有外部訊號皆需經由 PLC 輸入模組將開關量轉換為內部狀態，由程式執行控制運算。正確掌握接線原理，才能避免控制流程錯誤。

### 1\.2 COM 點與 0V 的角色🔌

「COM」為公共端，多數情境下視同 0V，是回路訊號的基準點。所有輸出/入的判斷依據都需連回 COM，錯誤接線很容易導致整體控制異常。
不同品牌 PLC COM 設計略有差異，應遵照規範接線。

### 1\.3 SINK（下沉）/SOURCE（源出）接線方式💡

• **SINK 型**：COM 接正極（+），訊號接地（-）才為 ON，多數日系標準。

• **SOURCE 型**：COM 接負極（-），訊號拉高電位（+）為 ON，歐美常見。

現場選型及元件搭配需依邏輯正確銜接，否則會造成無法偵測或控制失效。

### 1\.4 NPN/PNP 晶體管類型

• **NPN（下沉）**：當訊號腳接地（低電位）時動作，適合與 SINK 類搭配。

• **PNP（拉電）**：當訊號腳接正極（高電位）時動作，適合 SOURCE 類。

PLC 與現場感測器型態須相同才會動作正常。

## 常用元件與功能輔助 ⚙️

### 2\.1 內部與鎖存繼電器🧲

• **內部繼電器**：僅在 PLC 上電時持有狀態，斷電即失。

• **鎖存繼電器**：斷電再上電後仍能保持狀態，適用於需記憶啟動、異常或計數的場合。

### 2\.2 F警報、B串連繼電器

• **F繼電器**用於警報提示，例如異常燈號；

• **B 繼電器**多用於系統訊號鏈結、通訊連結應用。

• 可利用 LEDR 指令將所有警報快速清除。

### 2\.3 輔助繼電器 & 順序控制

• **SM400、SM402、SM412 等輔助繼電器**，常負責內部條件判斷，協助程式區塊化、分段與臨時存放邏輯狀態。

### 2\.4 雙線圈問題與規避

• 主程式內不可同時有兩個相同輸出線圈（主控物件）進行控制，避免覆寫與衝突。有需要時應以子程序、Set/Reset 指令或條件式分段防止重複。

### 2\.5 ONESHOT 上升/下降沿指令（LDP、LDF）

• 可產生狀態轉變瞬間的脈衝動作，只在訊號「由 OFF 轉 ON（上升沿）」或「ON 轉 OFF（下降沿）」的當下動作一次，常用於計數或一次性動作控制。

## 邏輯控制、計數與定時⏱️

### 3\.1 計數器 C 指令

• 用於記錄重複動作次數，如馬達運轉幾次停一次。

• 建議以「輸出接近訊號的下降沿」做觸發，確保最後的開關訊號不漏失。

### 3\.2 定時器 T 指令

• 分為低速和高速兩型，支援單次延遲和累計計時。

• 實際應用如：旅館房卡取出後延遲斷電，或自動控制週期噴水、照明等。

## 數值、字串運算與比較 📊

### 4\.1 MOVE 搬移指令

• **MOV**：將整數單字資料移動。

• **DMOV/EMOV**：用於更大範圍（如 32 位元資料）、浮點數搬移。

• **$MOV**：專門搬移字串型數據。

• 在程式裡可以依需求進行「單字→雙字→浮點→字串」各類型搬移與數據區指標設計。

### 4\.2 整數、浮點、字串運算

• 支援加減乘除、16/32位元及浮點

data 的轉換，並可累加、自減到指定暫存器。

• 亦支援開平方與特殊數學運算，編程上有對應指令配合。

### 4\.3 各類型數值比較

• 能針對整數、浮點數乃至文字內容直接做>、<、=、≠等比對。

• 範例：投幣販賣機編程，需判斷鈔票金額（如 D0 ≥ 2）、確認按鈕已按下，且同時避免誤重複出貨。

## 程式架構與模組化 🛠️

### 5\.1 主程式與子程序互動

• **子程序（Subroutine）**：用於分解複雜流程、復用相同區段，又可避免主程式重複線圈衝突。

• 跨組件（如多站位控制）要正確使用指標（參數化）呼叫對應子程序。

### 5\.2 內嵌 ST（結構化文本）

• 在梯形圖程式中嵌入 ST 區塊，能即時處理複雜計算或字串/數據處理，並可在編輯介面直接監控。

## 通訊介面、協議與模組設定🌐

### 6\.1 FL-net (OPCN-2) 流程

1\. **硬體挑選與模組安裝**（如三菱 QJ71FL71），搭配專用乙太網線

2\. 指定設備 **IP 及站號**（多用 192.168.250.x，且每台須唯一站號）

3\. 選擇 **循環傳輸或訊息傳輸模式**

4\. 使用 Configurator 工具設定各類參數、映射交換區與數據同步頻率

5\. 編寫對應的資料讀/寫監控程式，加強異常偵測邏輯

出現連線異常時可從硬體――IP 設定――參數核對到診斷工具依步排查。

### 6\.2 CC-Link 模組配置

• 通訊同樣需正確接線、明確設波特率、資料區位址、站號。

• 實際接線、現場布線、參數設定與現場狀態需全數對應正確。

• 系統監控時，亦可透過設定總覽、LED 指示、現場訊號驗證等多管齊下做好測試與排錯。

## 實務應用範例與異常處理 🚦

### 7\.1 限位單汽缸自動循環

以單一汽缸控制為例，配合兩點限位開關設計：

• 初始原點復歸→輸出啟動→汽缸伸展達前緣限位→自動切換縮回→回到原點。

• 面對多出口、複雜流程時可依序擴充並分層子程序處理。

### 7\.2 異常警報與錯誤記錄

• 程式中設監看旗標（如 M400）檢查超限或動作異常，自動輸出警報旗標、啟動蜂鳴或燈號等外部提示。

• 同時呼叫異常處理子程序協助記錄與流程善後，使系統穩健。

## PLC 設計/開發標準流程 📝

1\. 明確需求分析、工藝流程拆解

2\. 匹配所需 IO 點數與 PLC 型號

3\. 畫配線圖（紙本或軟體）

4\. 實際施工並連接現場設備

5\. 完成硬體檢查與連網整合

6\. 程式設計（梯形圖+結構化文本搭配）、完善註記

7\. 現場調試與最佳化（修正流程、優化速度、可靠性）

8\. 驗收與交付，年維護手冊撰寫、操作說明教育
